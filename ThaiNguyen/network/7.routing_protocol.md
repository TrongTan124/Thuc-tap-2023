## Cơ chế định tuyến
- cơ chế định tuyến là cơ chế được sử dụng trong định tuyến động để cho phép các bộ định tuyến trao đổi thông tin định tuyến với nhau. Điều này cho phép các bộ định tuyến cập nhật bảng định tuyến của chúng theo những thay đổi xảy ra trong mạng và chọn tuyến đường tốt nhất để chuyển tiếp lưu lượng mạng.

### Administrative distance
 - là một tính năng được router dùng để chọn route tốt nhất cho việc truyền các gói tin khi có 2 hoặc hơn route đến cùng một điểm đích nhưng sử dụng các cơ chế định tuyến khác nhau. Administrative distance giúp xác định độ đáng tin cậy của các cơ chế định tuyến. Giá trị này càng nhỏ thì có độ đáng tin cậy càng lớn. Với 2 hoặc hơn route với các cơ chế định tuyến khác nhau,router sẽ chọn route có AD value thấp nhất và truyền gói tin bằng cơ chế định tuyến tương ứng với AD value đó.  Giá trị được gán cho từng loại cơ chế định tuyến sẽ khác nhau tùy vào vendor.
 Ví dụ bảng AD value của Cisco sẽ như sau :
 
 ![pic](images/cisco.png)
 
Ba cơ chế định tuyến động phổ biến sẽ được thảo luận dưới đây:

## Routing Information Protocol (RIP)
### Sơ lược 
RIP là một giao thức định tuyến động sử dụng số hop làm chỉ số định tuyến để tìm tuyến đường tốt nhất từ nguồn đến đích. Nó được phân loại là một giao thức định tuyến theo vectơ khoảng cách(distance vector).

Số hop được xác định là số lượng bộ định tuyến giữa nguồn và đích. Route có số hop thấp nhất được coi là route tốt nhất và được đưa vào bảng định tuyến(routing table). Router sẽ chọn quãng đường có số hop thấp nhất trong routing table để truyền các gói tin đi. Số hop tối đa cho cơ chế RIP là 15, nếu một địa chỉ có số hop 16 hoặc lớn hơn thì được coi là không thể truy cập.
 RIP trao đổi các bản cập nhật của mạng theo định kỳ giữa các router và các bản cập nhật luôn được phát trong mạng. Router đầy đủ được gửi trong bản cập nhật. Các router luôn tin tưởng thông tin định tuyến nhận được từ các bộ định tuyến lân cận.
 
### Cách hoạt động
- Các bộ định tuyến khám phá các bộ định tuyến lân cận của chúng và chỉ trao đổi thông tin với các router lân cận được kết nối trực tiếp
- Mỗi bộ định tuyến định kỳ phát thông tin định tuyến của nó tới các bộ định tuyến lân cận khác, bao gồm các bảng định tuyến có địa chỉ IP và số bước nhảy cần thiết để đến các địa chỉ này
- Khi một bộ định tuyến nhận được cập nhật định tuyến từ các láng giềng của nó, nó sẽ so sánh bảng định tuyến trong bản cập nhật với bảng định tuyến của chính nó. Bất kỳ tuyến đường nào có số bước nhảy nhỏ hơn tuyến đường hiện có trong bảng định tuyến của nó đều được cập nhật tương ứng và bất kỳ tuyến đường nào chưa có trong bảng định tuyến đều được thêm vào. Bộ định tuyến chọn tuyến đường tốt nhất dựa trên tuyến đường có số bước nhảy ngắn nhất.
- RIP sử dụng một cơ chế gọi là split horizon để ngăn chặn các routing loop. Sử dụng cơ chế này, một bộ định tuyến không quảng cáo các tuyến trở lại cùng một giao diện mà nó nhận được. RIP cũng sử dụng poison reverse để thông báo cho các bộ định tuyến về các mạng không thể truy cập được. Những cơ chế này sẽ được thảo luận nhiều hơn dưới đây.
- RIP sử dụng timer để quản lý việc quảng bá thông tin định tuyến. Các bản cập nhật được gửi định kỳ đến các bộ định tuyến khác và nếu một route không được cập nhật trong một thời gian nhất định, nó được coi là không hợp lệ và sẽ bị xóa khỏi bảng định tuyến trong mỗi bộ định tuyến.
- Hội tụ(convergence): khi bộ định tuyến trao đổi thông tin với các bộ định tuyến khác và cập nhật bảng định tuyến của nó, mạng sẽ hội tụ ở trạng thái mà tất cả các bộ định tuyến đều có thông tin định tuyến nhất quán.

### Routing loop
Routing loop happens when data is routed in a loop between two routers without ever reaching its destination due to a network failure. RIP utilizes the split horizon mechanism to prevent this from happening. 

Split horizon applies a rule that states a router should not advertise routes back to the same interface it receives them. This helps prevent the situation where routers receives their own advertisement in a loop.


## Poison reverse
Poison reverse mechanism is often used with split horizon to further reduce the likelihood of routing loops.


